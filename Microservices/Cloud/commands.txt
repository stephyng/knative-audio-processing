# Create a working directory in which you are going to deploy Pulumi
mkdir pulumi
cd pulumi

pulumi new kubernetes-python

# Paste your Pulumi Access Token or login in your browser to Pulumi

# Fill out the details of your project
# Name: knative-audio-processing-final-test
# Desc.: A Knative audio processing application
# Dev - TODO
# Choose "yes" when prompted to do so

# Wait for all pods and triggers to fully load and achieve working status

kubectl get svc -n minio

# login in your browser to minio
# kubectl get svc -n minio --> â€¦ 9000:<>/TCP,9001:<>/TCP
# http://<Public IP>:32520
# - user: minioadmin
# - passwd: minioadmin

mc alias set local http://127.0.0.1:<> minioadmin minioadmin

mc mb local/knative-audio-processor

mc admin config set local notify_webhook:knative endpoint="http://knative-minio-processor.default.svc.cluster.local/minio-event"

mc admin service restart local

mc event add local/knative-audio-processor arn:minio:sqs::knative:webhook --event put

# UPLOAD a .mp3 file to be processed or use:
mc cp ~/knative-audio-processing/_MP3-files/tts.mp3 local/knative-audio-processor/

# If you want to check out the logs of a given microservice pod use:
kubectl logs -l serving.knative.dev/service=knative-<Pod name> -c user-container --tail=100